<HTML>
<!--                                                                      -->
<!-- jMax                                                                 -->
<!--                                                                      -->
<!-- Copyright (C) 1999 by IRCAM                                          -->
<!-- All rights reserved.                                                 -->
<!--                                                                      -->
<!-- This program may be used and distributed under the terms of the      -->
<!-- accompanying LICENSE.                                                -->
<!--                                                                      -->
<!-- This program is distributed WITHOUT ANY WARRANTY. See the LICENSE    -->
<!-- for DISCLAIMER OF WARRANTY.                                          -->
<!--                                                                      -->
<HEAD>
<TITLE>Language Layer: Basic Types</TITLE>
</HEAD>

<BODY TEXT="#000000" BGCOLOR="#CCCCCC">

<TABLE WIDTH=100% BORDER=0 CELLSPACING=0 CELLPADDING=0>
<TR>
  <TD ALIGN=LEFT>
    <A HREF="http://www.ircam.fr/jmax/"><IMG SRC="../../../../../images/jmax_logo_tiny.gif" BORDER=0 ALT="jMax"></A>
  </TD>
  <TD ALIGN=RIGHT>
    <A HREF="http://www.ircam.fr/"><IMG SRC="../../../../../images/ircam_banner.gif" BORDER=0 ALT="IRCAM - Centre Georges Pompidou"></A>
  </TD>
</TR>
</TABLE>
<BR>
<UL TYPE=SQUARE>
  <LI><A HREF=../../../../index.html>Documentation</A>
  <UL TYPE=SQUARE>
    <LI><A HREF=../../../index.html><b>The <i>j</i>Max Architecture</b></a>
      <UL TYPE=SQUARE>
      <LI><A HREF=../../index.html><b>The FTS Computational Engine</b></a>
        <UL TYPE=SQUARE>
        <LI><A HREF=../index.html><b>The Language Layer</b></a>
	  <UL TYPE=SQUARE>
          <LI><A HREF=index.html><b>The Message System</b></a>
          </UL>
        </UL>
      </UL>
  </UL>
</UL>

<p>
<font size=+3 color=#FFFFFF><b>Basic Types</b></font>
<p>
<hr noshade size=1>

<UL TYPE=DOT>
  <LI><A HREF="#symbols"> Symbols </A>
  <LI><A HREF="#words">   Words </A>
  <LI><A HREF="#atoms">   Atoms </A>
  <LI><A HREF="#files">   Related Files </A>
</UL>

<p>
<hr noshade size=1>

<TABLE WIDTH=100% BORDER=0 CELLSPACING=1 CELLPADDING=20 BGCOLOR=#FFFFFF>
<TR><TD>

<A NAME="symbols"> 
<H2> Symbols </H2> 
<P>
Symbols are opaque types uniquely representing a string; the 
symbol <code>name</code> is the string corresponding to the symbol; 
two symbols whose names are equal (i.e. for which the <code>strcmp</code>
function return <code>0</code>) are the same symbol (i.e. <code>==</code>
between them will return true).
<p>
Symbols are created from a string with dedicated functions; in order
to avoid duplicating static strings, the default version, <code>fts_symbol_new</code>,
will store a pointer to the string passed as argument; a special version,
<code>fts_symbol_new_copy</code>, must be used when the string passed as argument
cannot be shared, like in the case of a local buffer; using the first version
with a pointer to a local, changable buffer, can result in any kind
of behaviour, including memory corruption and system crashes.
<p>
Symbols include support for two <code>non-visible</code> functionalities:
symbol caching in the communication with the kernel, and operator identification
in expression evaluation; see the relative chapters for details.
<p>
The <code>symbol.h</code> file define a set of <code>C</code> variables for the
symbols used in the FTS kernel, to avoid calling the <code>fts_symbol_new</code>
function at run time; all the <code>C</code> variable symbols defined in the kernel
should be defined here.
<p>
The implementation of the symbol table use a home made hash table of linked
list of symbols, with a simple hashing function on symbol names.
<p>
As in many other case in the FTS kernel, most of the symbol access function
are actually macro, so they cannot be called thru pointers.
<p>
  
<A NAME="words"> 
<H2> Words </H2> 
<P>

In many places FTS need to represent generic data of etherogeneous
types; two basic mechanisms are provided, words and atoms; a word
(type <code>fts_word_t</code>) is an union of the <i>interesting</i>
basic C type; they include <code>int</code> and <code>float</code>,
<code>symbols</code>, pointers to <code>void</code> and pointer to
function returning <code>void</code>; note that types that tipically
need 64 bits (at least on a 32 bit machine) as <code>double</code> are
not included; a set of macros allow to set and get values of different
types without the need of knowing the concrete definition of the
<code>fts_word_t</code> type.
<p>
Note that words do not really intend to be the FTS generic type mechanism,
but only the basic implementation for a value or a reference value in a more
complex type system; see below.

<A NAME="atoms"> 
<H2> Atoms </H2> 
<P>
An Atom is a type tagged value; atoms are the standard way to represent,
and pass values to functions and methods in FTS; they are also the basic
unity of communication between FTS and the graphical clients.
<p>
There are two kind of values: basic, scalar values and reference
types; scalar values are <code>int</code>, <code>float</code> and
<code>symbols</code>, booleans and void values; reference types are
type tagged pointers to other entities; currently, those entities can
be strings, fts objects, ftsconnections, data, atom_array and
<code>void *</code> pointers; see the other chapter for details on
each type; some of these types are supported essentially for the sake
of communication with the client, and others as a support to the
message system; a number of macros allow atoms manipulation; the internal
structure of a atom should never be accessed directly, because it can
change (and it does change) between different releases.
<p>
The module provide a small set of basic functions, like test for equalities
and printing and formatting functions.
<P>
Type tags are implemented as symbols, but we plan a short term introduction
of a new type descriptor data type.
<P>
The most essential thing to understand about atoms is that while they bring
some resemblance, and bring naturally to thing they are a basic MAX language feature,
and the basic mechanism for building a power type system in FTS,
actually they are *not*; for the moment, they are an implementation technique,
in order to represent and refer conveniently to a number of vastly different data types
(like fts objects, representing a statement in the MAX language, or a integer,
representing a datum in the MAX computation, or again the whole content of an object like explode
that is actually the private state of an object, exported to an editor on the client side),
in vastly different situations (like editing a patch, executing a patch, editing a sequence);
they are <i>also</i> used to represent the data used in the execution of a patch, so they
are <i>also</i> used to implement the MAX language features, but there is <strong>no</strong>
equivalence between the two, and assuming this equivalence will bring to a failure.
<p>
Conceptually defining this equivalence, and finding the proper way to implement it without
changing the MAX language paradigm, and without cutting compatibility with existing patch
is one of the most time consuming brainstorming activity of the <i>j</i>Max developement
team.

<P>

<A NAME="files"> 
<H2> Related Files</H2> 
<P>

<ul> 
<li> <code>mess_types.h</code>
<li> <code>words.h</code>
<li> <code>atoms.c</code>
<li> <code>atoms.h</code>
<li> <code>symbols.c</code>
<li> <code>symbols.h</code>
</ul>

</TABLE>
<HR NOSHADE SIZE=1>

</BODY>
</HTML>



