Name: jmax
Summary: a visual programming environment for real-time, interactive multimedia applications
Version: @VERSION@
Release: 1
Copyright: GPL
Group: Applications/Multimedia
Source: ftp://ftp.ircam.fr/pub/IRCAM/equipes/temps-reel/jmax/releases/jmax-%{version}.tar.gz
BuildRoot: /var/tmp/jmax-%{version}-root

%description
jMax is a visual programming environment for developing real-time, interactive multimedia applications. 


%package common
Summary: Kernel of JMax
Group: Application/Multimedia
%description common
jMax FTS kernel

%package devel
Summary: Header files for jMax
Group: Development/Libraries
Requires: %{name} = %{version} 
%description devel
Header files for jMax

%package java
Summary: Java gui for jMax
Group: Applications/Multimedia
%description java
Java Graphical User Interface for jMax

%prep
%setup -n jmax-%{version}
%build
./configure
make

%install
rm -f /var/tmp/rpm.jmax.common.list
rm -f /var/tmp/rpm.jmax.java.list
rm -rf $RPM_BUILD_ROOT
make DESTDIR=$RPM_BUILD_ROOT install
# library files for common rpm 
find $RPM_BUILD_ROOT/usr/share/jmax/packages -name "lib*.so" | sed "s|$RPM_BUILD_ROOT||g" >> /var/tmp/rpm.jmax.common.list
# jpkg files for common rpm
find $RPM_BUILD_ROOT/usr/share/jmax/packages -name "*.jpkg" | sed "s|$RPM_BUILD_ROOT||g" >> /var/tmp/rpm.jmax.common.list
# help files for common rpm
find $RPM_BUILD_ROOT/usr/share/jmax/packages -type d -name "help" | sed "s|$RPM_BUILD_ROOT||g" >> /var/tmp/rpm.jmax.common.list
# for java rpm
find $RPM_BUILD_ROOT/usr/share/jmax -name "*.jar" | sed "s|$RPM_BUILD_ROOT||g" >> /var/tmp/rpm.jmax.java.list

%clean
rm -rf $RPM_BUILD_ROOT

%post

%files
%defattr(-, root, root)
%doc LICENCE.fr LICENSE README doc/*
%{_bindir}/jmax
%{_bindir}/fts
%{_libdir}/libfts-%{version}.so
%{_libdir}/libfts.so
/usr/share/jmax

%files common -f /var/tmp/rpm.jmax.common.list
%defattr(-,root,root)
%{_bindir}/fts
%{_libdir}/libfts-%{version}.so
%{_libdir}/libfts.so

%files devel
%defattr(-,root,root)
%{_bindir}/jmax-config
%{_includedir}/fts
%{_libdir}/libfts.la
%{_libdir}/pkgconfig/jmax.pc

%files java -f /var/tmp/rpm.jmax.java.list
%defattr(-,root,root)
%{_bindir}/jmax

%changelog
* Thu Nov 21 2002 Patrice Tisserand <Patrice.Tisserand@ircam.fr>
- first set up for multi rpm building

